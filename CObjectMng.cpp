/*====================================================================================

	オブジェクト管理リストクラス　 [CObjectMng.cpp]
																Autor	: 西口
																Date	: 2018/10/19
--------------------------------------------------------------------------------------
コメント:
--------------------------------------------------------------------------------------
修正日時:
====================================================================================*/


/*--------------------------------------------------------------------------------------
	インクルードファイル
--------------------------------------------------------------------------------------*/
#include "CObjectMng.h"

/*--------------------------------------------------------------------------------------
	列挙型 : 構造体
--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------
	マクロ定義
--------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------
	クラス実行部分
--------------------------------------------------------------------------------------*/

//実体生成
CObjectMng* CObjectRegister::m_pObjectMng = NULL;

/*-------------------------------------------
	オブジェクト管理リスト
-------------------------------------------*/

//アップデート
void CObjectMng::Update() {

	//イテレータの作成
	std::list<CObjectRegister*>::iterator it;

	//リスト内のオブジェクトのアップデート
	for (it = m_pObjectList.begin(); it != m_pObjectList.end(); ) {
		if ((*it)) {
			if (!((*it)->Update())) {
				
				//メモリの解放
				delete (*it);

				//リストから削除
				it = m_pObjectList.erase(it);

				//続ける
				continue;

			}

			//オブジェクトを削除しなかった場合カウントアップ
			it++;

		}
	}

}

//描画
void CObjectMng::Draw() {

	//イテレータの作成
	std::list<CObjectRegister*>::iterator it;

	//リスト内のオブジェクトの描画
	for (it = m_pObjectList.begin(); it != m_pObjectList.end(); it++) {

		if ((*it)) {

			//描画
			(*it)->Draw();

		}
	}

}


/*-------------------------------------------
	オブジェクト登録クラス
-------------------------------------------*/

//コンストラクタ : デフォルト
CObjectRegister::CObjectRegister() {

	//登録関数
	m_pObjectMng->Regist(this);

}

